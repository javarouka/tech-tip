# 신규 프로젝트 개발기

신규 통합 CS 오버뷰 시스템 관리 개발기.

## CS(Customer Service) 관리 프로그램이다!

현재로부터 5년전, 회사에 입사한 뒤로 무려 지금까지 맡게 된 업무는 CS 상담 관리 프로그램이었다.

막 입사했을때는 사내 시스템의 MSA(`M`icro `S`ervice `A`rchitecture) 의 시작기였고 개발자 수가 적어 상담 관리 말고도 취소/반품/교환/상품리뷰/마이쿠팡 ... 기타등등을 전부 했었지만 시간이 지나면서 각 롤별로 팀이 나뉘어지고 본격적으로 CS 에만 집중할 수 있는 환경이 만들어졌다.

전자상거래 CS 관리 프로그램이라는 건 생각보다 복잡하다.

- 회원정보 조회
- 회원 정보 (아이디, 계좌, 주소지 ...때로는 탈퇴처리) 변경
- 이 회원이 주문한 내역
- 이 회원이 최근 주문한 상품
- 이 회원의 상담 이력
- 상품 판매 업체와 연동
- 택배 연동
- 메시지, 전화 등의 Channel 연동
- etc ...

이런 정보를 통합 관리하는 프로그램이다.

자세히 보면 전자상거래에서 다뤄지는 거의 모든 도메인이 다뤄진다고 볼 수 있다. 그만큼 의존성이 문어발 식으로 연결되어있고, 그만큼 타 도메인에 영향을 많이 받는다.

<div style="text-align: center">
    <img src="octocat.png" alt="나...?">
    <br/>
    <em>나 말하나...?</em>
</div>

과장해서 말하면, 타 도메인에서 재채기를 하면 감기에 걸릴수도 있는게 CS 관리 프로그램인 것이다.

## 버틸수가 없다

MSA 환경에서 동시다발적으로 벌어지는 각 도메인들의 변화를 추적하고 반영하다보면, 쉴새없는 오류와, 호환성 문제를 겪게 되며, 그럴수록 소주 한병 걸치고 쓰레기를 가듣 실은 트럭으로 시속 200 Km 으로 달리는 운전자의 심리상태같은 느낌의 결과물이 나오게 된다.

아마 CS 개발자 대부분이 어떤 로직에 추가사항을 넣으려고 할때 *오... 이 코드는 누가 만들었지* 하며 `git blame` 을 (혹은 annotation) 을 안해본 사람이 없으리라.
(때로는 이 결과물이 나라는 것이 개그다.)

테스트 코드 부재는 예사이고, 팀원들끼리 충분한 커뮤니케이션이 없으면 중복된 코드가 각자의 개성으로 이곳저곳에서 자라난다.

그 코드가 관련된 도메인이 변할 경우 이곳저곳에서 자란 해당 코드 모두가 수정되어야 한다.
새 기능이 추가될 때 하나라도 이 부분을 누락하면 바로 장애로 이어지거나 유지보수건으로 BTS(업무요청사항) 가 등록된다.

리팩토링?

리팩토링 범위를 아무리 최소로 해도 하다보면 너무나 광범위한 영역을 다루게 되며 결국 포기하는 일이 많다. 리팩토링이 때로는 새로운 버그를 만들기도 한다. (이건 뭐 다른 상황에서도 마찬가지이지만;) 

이런 환경속에서 부족한 리소스로 일을 진행하면서 몇차례의 개편을 하다보니 코드의 유지보수성에 많은 생각을 하게 되었다.

- 외부 변화에 큰 타격이 없을 것
- 도메인 대응이 늦어도 해당 기능을 제외하고는 정상 동작해야 할것
- 새 기능의 추가가 쉬울 것
- 프로그램 속도에 문제가 없을 것
- 재미있을 것(?)

이러한 고민은 회사를 다니면서 내마음 한구석에 항상 있었다.

이런 생각이 정리되어 가던 때에 드디어 다시한번 개편을 시도할 기회가 생기게 되었다.

## 욕심은 많고...

하는김에 이것저것 써보자. 국제화도 넣고...
부페 코딩의 시작

## 서버 코드의 레이어링
서비스는 휘발성
실제 비즈니스 로직 1유닛(?)은 Behavior.
요구사항은 애초에 명확할수가 없다. 명확한 요구사항도 시간이 가면 불명확해지는 존재하지 않는 내 여자친구 같은 존재

## Server API 의 난도질
한방 API 는 유지보수성에 장애 VS 성능
타협안은.
문서화가 부족

## Client 군의 반응
난도질당한 서버 API의 통합과 처리.
답은 Reselect

## 불편한 도구들
실제 적용해봤지만 생각대로 잘 되지 않는다.
특히 익숙하지 않은 도구로 정해진 스캐폴딩 없이 개발은 지옥

## 라우터와 스토어
결국 라우터 재구현과 스토어의 계층화

## React, Redux, Saga ... Material, Styled-Component
여러 라이브러리들에 얽힌 이야기
${props => props.xxx} 에서 ${props => props.xxx}; 콜론 안붙이면 패망.

## 마무리
좋았다.
전체적인 전지적 작가 시점의 Behavior 설계가 있었다면 더 훌륭한 결과가 나오지 않았을까. 비즈니스 이해라는건 해도해도 어려운 것이다.

서버 API 문서화 실종
아쉬운점은 Style Component 화를 좀더 구체적으로 했다면.
DTO 정의를 좀더 일찍 했다면
Behavior 정의를 좀 더 구체적으로 했다면
컬러는 반드시 변수화